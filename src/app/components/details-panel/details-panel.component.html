<aside class="details">
  <div class="details-card">
    <h2>{{ selectedDayTitle }}</h2>

    <ng-container *ngIf="selectedDay; else monthOverview">
      <div class="details-balance">
        <p>Saldo projetado no dia</p>
        <strong [class.negative]="selectedDay.balance < 0">
          {{ formatCurrency(selectedDay.balance) }}
        </strong>
      </div>
      <div class="details-row">
        <div>
          <span class="label">Entradas do dia</span>
          <span class="value">
            {{ formatCurrency(selectedDay.income) }}
          </span>
        </div>
        <div>
          <span class="label">Saídas do dia</span>
          <span class="value negative">
            {{ formatCurrency(selectedDay.expenses) }}
          </span>
        </div>
      </div>
      <div class="transactions">
        <h3>Eventos relevantes</h3>
        <p *ngIf="selectedDay.transactions.length === 0" class="muted">
          Nenhum evento registrado para este dia.
        </p>
        <ul *ngIf="selectedDay.transactions.length">
          <li *ngFor="let transaction of selectedDay.transactions">
            <div>
              <p class="transaction-title">{{ transaction.title }}</p>
              <span class="muted">{{ transaction.category }}</span>
            </div>
            <span [class.negative]="transaction.amount < 0">
              {{ formatCurrency(transaction.amount) }}
            </span>
          </li>
        </ul>
      </div>
      <button
        class="primary full"
        type="button"
        *ngIf="focusedMonth"
        (click)="openBudget.emit(focusedMonth)"
      >
        Ver orçamento de {{ focusedMonth.label }} {{ focusedMonth.year }}
      </button>
    </ng-container>

    <ng-template #monthOverview>
      <div class="details-balance">
        <p>Saldo no início de {{ focusedMonth?.label }} {{ focusedMonth?.year }}</p>
        <strong [class.negative]="focusedMonth?.startBalance && focusedMonth.startBalance < 0">
          {{ focusedMonth ? formatCurrency(focusedMonth.startBalance) : '—' }}
        </strong>
      </div>
      <div class="details-row">
        <div>
          <span class="label">Saldo final estimado</span>
          <span class="value" [class.negative]="focusedMonth?.endBalance && focusedMonth.endBalance < 0">
            {{ focusedMonth ? formatCurrency(focusedMonth.endBalance) : '—' }}
          </span>
        </div>
        <div>
          <span class="label">Status do orçamento</span>
          <span class="value" [class.negative]="focusedMonth && !focusedMonth.budgetConfigured">
            {{ budgetStatusLabel }}
          </span>
        </div>
      </div>
      <div class="details-row">
        <div>
          <span class="label">Entradas do mês</span>
          <span class="value">
            {{ focusedMonth ? formatCurrency(focusedMonth.incomeTotal) : '—' }}
          </span>
        </div>
        <div>
          <span class="label">Saídas do mês</span>
          <span class="value negative">
            {{ focusedMonth ? formatCurrency(focusedMonth.expensesTotal) : '—' }}
          </span>
        </div>
      </div>
      <button
        class="primary full"
        type="button"
        *ngIf="focusedMonth"
        (click)="openBudget.emit(focusedMonth)"
      >
        Ver orçamento do mês
      </button>
    </ng-template>
  </div>
</aside>
