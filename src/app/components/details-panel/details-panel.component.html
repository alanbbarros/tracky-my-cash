<aside class="details">
  <div class="details-card">
    <h2>{{ selectedDayTitle }}</h2>
    <p class="muted" *ngIf="focusedCycle">
      {{ focusedCycle.cycleRangeLabel }} • venc. {{ focusedCycle.dueDateLabel }}
    </p>

    <ng-container *ngIf="selectedDay; else monthOverview">
      <div class="details-balance">
        <p>Saldo projetado no dia</p>
        <strong [class.negative]="selectedDay.balance < 0">
          {{ formatCurrency(selectedDay.balance) }}
        </strong>
      </div>
      <div class="details-row">
        <div>
          <span class="label">Entradas do dia</span>
          <span class="value">
            {{ formatCurrency(selectedDay.income) }}
          </span>
        </div>
        <div>
          <span class="label">Saídas do dia</span>
          <span class="value negative">
            {{ formatCurrency(selectedDay.expenses) }}
          </span>
        </div>
      </div>
      <div class="transactions">
        <h3>Eventos relevantes</h3>
        <p *ngIf="selectedDay.transactions.length === 0" class="muted">
          Nenhum evento registrado para este dia.
        </p>
        <ul *ngIf="selectedDay.transactions.length">
          <li *ngFor="let transaction of selectedDay.transactions">
            <div>
              <p class="transaction-title">{{ transaction.title }}</p>
              <span class="muted">{{ transaction.category }}</span>
            </div>
            <span [class.negative]="transaction.amount < 0">
              {{ formatCurrency(transaction.amount) }}
            </span>
          </li>
        </ul>
      </div>
      <button
        class="ghost full"
        type="button"
        *ngIf="focusedCycle"
        (click)="openBudget.emit(focusedCycle)"
      >
        Ver orçamento da fatura
      </button>
    </ng-container>

    <ng-template #monthOverview>
      <div class="details-balance">
        <p>Saldo no início da fatura</p>
        <strong [class.negative]="focusedCycle?.startBalance && focusedCycle.startBalance < 0">
          {{ focusedCycle ? formatCurrency(focusedCycle.startBalance) : '—' }}
        </strong>
      </div>
      <div class="details-row">
        <div>
          <span class="label">Saldo final estimado</span>
          <span class="value" [class.negative]="focusedCycle?.endBalance && focusedCycle.endBalance < 0">
            {{ focusedCycle ? formatCurrency(focusedCycle.endBalance) : '—' }}
          </span>
        </div>
        <div>
          <span class="label">Status do orçamento</span>
          <span class="value" [class.negative]="focusedCycle && !focusedCycle.budgetConfigured">
            {{ budgetStatusLabel }}
          </span>
        </div>
      </div>
      <div class="details-row">
        <div>
          <span class="label">Entradas da fatura</span>
          <span class="value">
            {{ focusedCycle ? formatCurrency(focusedCycle.incomeTotal) : '—' }}
          </span>
        </div>
        <div>
          <span class="label">Saídas da fatura</span>
          <span class="value negative">
            {{ focusedCycle ? formatCurrency(focusedCycle.expensesTotal) : '—' }}
          </span>
        </div>
      </div>
      <button
        class="ghost full"
        type="button"
        *ngIf="focusedCycle"
        (click)="openBudget.emit(focusedCycle)"
      >
        Ver orçamento da fatura
      </button>
    </ng-template>
  </div>
</aside>
