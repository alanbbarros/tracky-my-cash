<section class="invoice" *ngIf="card && cycle">
  <header class="invoice-header">
    <div>
      <h2>Fatura do cartão {{ card.name }}</h2>
      <p class="muted">{{ cycle.periodLabel }} • venc. {{ cycle.dueDate | date: 'dd/MM' }}</p>
    </div>
    <button class="primary" type="button" (click)="markAsPaid.emit()" [disabled]="cycle.status === 'paga'">
      Marcar fatura como paga
    </button>
  </header>

  <div class="invoice-summary">
    <div>
      <span class="label">Total da fatura</span>
      <strong class="negative">{{ formatCurrency(cycle.creditTotal) }}</strong>
    </div>
    <div>
      <span class="label">Limite utilizado</span>
      <strong>{{ usedLimitPercentage | number: '1.0-0' }}%</strong>
    </div>
    <div>
      <span class="label">Status</span>
      <strong>{{ cycle.status | titlecase }}</strong>
    </div>
  </div>

  <div class="invoice-list">
    <h3>Lançamentos no crédito</h3>
    <p *ngIf="creditTransactions.length === 0" class="muted">Nenhum lançamento de crédito neste ciclo.</p>
    <article *ngFor="let transaction of creditTransactions" class="invoice-item">
      <div>
        <strong>{{ transaction.title }}</strong>
        <p class="muted">
          {{ transaction.date | date: 'dd/MM/yyyy' }} • {{ transaction.category }}
          <ng-container *ngIf="formatInstallment(transaction)">• {{ formatInstallment(transaction) }}</ng-container>
        </p>
      </div>
      <div class="invoice-actions">
        <span class="negative">{{ formatCurrency(transaction.amount) }}</span>
        <button class="ghost" type="button" (click)="editTransaction.emit(transaction)">Editar</button>
      </div>
    </article>
  </div>
</section>
