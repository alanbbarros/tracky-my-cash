<div class="modal-backdrop" *ngIf="isOpen">
  <div class="modal">
    <header class="modal-header">
      <div>
        <h2>{{ transactionToEdit ? 'Editar lançamento' : 'Novo lançamento' }}</h2>
        <p class="muted">Registre entradas, saídas e recorrências.</p>
      </div>
      <button class="icon-button" type="button" (click)="onClose()">×</button>
    </header>

    <form class="modal-form" (ngSubmit)="onSubmit()">
      <label>
        Título do lançamento
        <input type="text" placeholder="Ex: Salário, Mercado" [(ngModel)]="form.title" name="title" />
      </label>

      <label>
        Categoria
        <input type="text" placeholder="Ex: Receitas, Mercado" [(ngModel)]="form.category" name="category" />
      </label>

      <label>
        Valor do lançamento
        <input type="number" placeholder="R$ 0,00" [(ngModel)]="form.amount" name="amount" />
      </label>

      <label>
        Tipo de lançamento
        <select [(ngModel)]="form.type" name="type">
          <option value="entrada">Entrada</option>
          <option value="saida">Saída</option>
        </select>
      </label>

      <label>
        Meio de pagamento
        <select [(ngModel)]="form.paymentMethod" name="paymentMethod">
          <option value="debito">Débito</option>
          <option value="credito">Crédito</option>
          <option value="pix">Pix</option>
        </select>
      </label>

      <label>
        Cartão
        <select [(ngModel)]="form.cardId" name="cardId" [disabled]="form.paymentMethod !== 'credito'">
          <option *ngFor="let card of cards" [value]="card.id">{{ card.name }}</option>
        </select>
      </label>

      <label>
        Parcelas
        <div class="split">
          <input
            type="number"
            min="1"
            [(ngModel)]="form.installmentCurrent"
            name="installmentCurrent"
            [disabled]="form.paymentMethod !== 'credito'"
          />
          <span class="muted">de</span>
          <input
            type="number"
            min="1"
            [(ngModel)]="form.installmentTotal"
            name="installmentTotal"
            [disabled]="form.paymentMethod !== 'credito'"
          />
        </div>
      </label>

      <label>
        Data do lançamento
        <input type="date" [(ngModel)]="form.date" name="date" />
      </label>

      <label>
        Recorrência
        <select [(ngModel)]="form.recurrence" name="recurrence">
          <option value="nenhuma">Sem recorrência</option>
          <option value="mensal">Mensal</option>
          <option value="quinzenal">Quinzenal</option>
          <option value="semanal">Semanal</option>
          <option value="trimestral">Trimestral</option>
        </select>
      </label>

      <div class="modal-actions">
        <button class="ghost" type="button" (click)="onClose()">Cancelar</button>
        <button class="primary" type="submit">
          {{ transactionToEdit ? 'Atualizar lançamento' : 'Salvar lançamento' }}
        </button>
      </div>
    </form>
  </div>
</div>
